"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});function Jt(){this.__data__=[],this.size=0}function jt(t,e){return t===e||t!==t&&e!==e}function F(t,e){for(var r=t.length;r--;)if(jt(t[r][0],e))return r;return-1}var Yt=Array.prototype,Zt=Yt.splice;function Xt(t){var e=this.__data__,r=F(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():Zt.call(e,r,1),--this.size,!0}function Qt(t){var e=this.__data__,r=F(e,t);return r<0?void 0:e[r][1]}function kt(t){return F(this.__data__,t)>-1}function te(t,e){var r=this.__data__,n=F(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}function p(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}p.prototype.clear=Jt;p.prototype.delete=Xt;p.prototype.get=Qt;p.prototype.has=kt;p.prototype.set=te;function ee(){this.__data__=new p,this.size=0}function re(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}function ne(t){return this.__data__.get(t)}function ae(t){return this.__data__.has(t)}var oe=typeof global=="object"&&global&&global.Object===Object&&global;const mt=oe;var ie=typeof self=="object"&&self&&self.Object===Object&&self,se=mt||ie||Function("return this")();const g=se;var ce=g.Symbol;const v=ce;var St=Object.prototype,ue=St.hasOwnProperty,fe=St.toString,w=v?v.toStringTag:void 0;function le(t){var e=ue.call(t,w),r=t[w];try{t[w]=void 0;var n=!0}catch{}var c=fe.call(t);return n&&(e?t[w]=r:delete t[w]),c}var ge=Object.prototype,pe=ge.toString;function he(t){return pe.call(t)}var be="[object Null]",de="[object Undefined]",tt=v?v.toStringTag:void 0;function x(t){return t==null?t===void 0?de:be:tt&&tt in Object(t)?le(t):he(t)}function C(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var ye="[object AsyncFunction]",$e="[object Function]",Te="[object GeneratorFunction]",_e="[object Proxy]";function wt(t){if(!C(t))return!1;var e=x(t);return e==$e||e==Te||e==ye||e==_e}var ve=g["__core-js_shared__"];const U=ve;var et=function(){var t=/[^.]+$/.exec(U&&U.keys&&U.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function je(t){return!!et&&et in t}var me=Function.prototype,Se=me.toString;function $(t){if(t!=null){try{return Se.call(t)}catch{}try{return t+""}catch{}}return""}var we=/[\\^$.*+?()[\]{}|]/g,Ae=/^\[object .+?Constructor\]$/,Oe=Function.prototype,Pe=Object.prototype,xe=Oe.toString,Ce=Pe.hasOwnProperty,Ie=RegExp("^"+xe.call(Ce).replace(we,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Ee(t){if(!C(t)||je(t))return!1;var e=wt(t)?Ie:Ae;return e.test($(t))}function Fe(t,e){return t==null?void 0:t[e]}function T(t,e){var r=Fe(t,e);return Ee(r)?r:void 0}var Me=T(g,"Map");const O=Me;var De=T(Object,"create");const P=De;function Ue(){this.__data__=P?P(null):{},this.size=0}function Ne(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var Be="__lodash_hash_undefined__",Le=Object.prototype,Ge=Le.hasOwnProperty;function ze(t){var e=this.__data__;if(P){var r=e[t];return r===Be?void 0:r}return Ge.call(e,t)?e[t]:void 0}var Re=Object.prototype,Ke=Re.hasOwnProperty;function He(t){var e=this.__data__;return P?e[t]!==void 0:Ke.call(e,t)}var Ve="__lodash_hash_undefined__";function qe(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=P&&e===void 0?Ve:e,this}function y(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}y.prototype.clear=Ue;y.prototype.delete=Ne;y.prototype.get=ze;y.prototype.has=He;y.prototype.set=qe;function We(){this.size=0,this.__data__={hash:new y,map:new(O||p),string:new y}}function Je(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function M(t,e){var r=t.__data__;return Je(e)?r[typeof e=="string"?"string":"hash"]:r.map}function Ye(t){var e=M(this,t).delete(t);return this.size-=e?1:0,e}function Ze(t){return M(this,t).get(t)}function Xe(t){return M(this,t).has(t)}function Qe(t,e){var r=M(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}function m(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}m.prototype.clear=We;m.prototype.delete=Ye;m.prototype.get=Ze;m.prototype.has=Xe;m.prototype.set=Qe;var ke=200;function tr(t,e){var r=this.__data__;if(r instanceof p){var n=r.__data__;if(!O||n.length<ke-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new m(n)}return r.set(t,e),this.size=r.size,this}function S(t){var e=this.__data__=new p(t);this.size=e.size}S.prototype.clear=ee;S.prototype.delete=re;S.prototype.get=ne;S.prototype.has=ae;S.prototype.set=tr;function er(t,e){for(var r=-1,n=t==null?0:t.length;++r<n&&e(t[r],r,t)!==!1;);return t}var rr=function(){try{var t=T(Object,"defineProperty");return t({},"",{}),t}catch{}}();const rt=rr;function At(t,e,r){e=="__proto__"&&rt?rt(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}var nr=Object.prototype,ar=nr.hasOwnProperty;function Ot(t,e,r){var n=t[e];(!(ar.call(t,e)&&jt(n,r))||r===void 0&&!(e in t))&&At(t,e,r)}function D(t,e,r,n){var c=!r;r||(r={});for(var a=-1,o=e.length;++a<o;){var u=e[a],f=n?n(r[u],t[u],u,r,t):void 0;f===void 0&&(f=t[u]),c?At(r,u,f):Ot(r,u,f)}return r}function or(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}function I(t){return t!=null&&typeof t=="object"}var ir="[object Arguments]";function nt(t){return I(t)&&x(t)==ir}var Pt=Object.prototype,sr=Pt.hasOwnProperty,cr=Pt.propertyIsEnumerable,ur=nt(function(){return arguments}())?nt:function(t){return I(t)&&sr.call(t,"callee")&&!cr.call(t,"callee")};const fr=ur;var lr=Array.isArray;const R=lr;function gr(){return!1}var xt=typeof exports=="object"&&exports&&!exports.nodeType&&exports,at=xt&&typeof module=="object"&&module&&!module.nodeType&&module,pr=at&&at.exports===xt,ot=pr?g.Buffer:void 0,hr=ot?ot.isBuffer:void 0,br=hr||gr;const Ct=br;var dr=9007199254740991,yr=/^(?:0|[1-9]\d*)$/;function $r(t,e){var r=typeof t;return e=e??dr,!!e&&(r=="number"||r!="symbol"&&yr.test(t))&&t>-1&&t%1==0&&t<e}var Tr=9007199254740991;function It(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Tr}var _r="[object Arguments]",vr="[object Array]",jr="[object Boolean]",mr="[object Date]",Sr="[object Error]",wr="[object Function]",Ar="[object Map]",Or="[object Number]",Pr="[object Object]",xr="[object RegExp]",Cr="[object Set]",Ir="[object String]",Er="[object WeakMap]",Fr="[object ArrayBuffer]",Mr="[object DataView]",Dr="[object Float32Array]",Ur="[object Float64Array]",Nr="[object Int8Array]",Br="[object Int16Array]",Lr="[object Int32Array]",Gr="[object Uint8Array]",zr="[object Uint8ClampedArray]",Rr="[object Uint16Array]",Kr="[object Uint32Array]",s={};s[Dr]=s[Ur]=s[Nr]=s[Br]=s[Lr]=s[Gr]=s[zr]=s[Rr]=s[Kr]=!0;s[_r]=s[vr]=s[Fr]=s[jr]=s[Mr]=s[mr]=s[Sr]=s[wr]=s[Ar]=s[Or]=s[Pr]=s[xr]=s[Cr]=s[Ir]=s[Er]=!1;function Hr(t){return I(t)&&It(t.length)&&!!s[x(t)]}function K(t){return function(e){return t(e)}}var Et=typeof exports=="object"&&exports&&!exports.nodeType&&exports,A=Et&&typeof module=="object"&&module&&!module.nodeType&&module,Vr=A&&A.exports===Et,N=Vr&&mt.process,qr=function(){try{var t=A&&A.require&&A.require("util").types;return t||N&&N.binding&&N.binding("util")}catch{}}();const j=qr;var it=j&&j.isTypedArray,Wr=it?K(it):Hr;const Jr=Wr;var Yr=Object.prototype,Zr=Yr.hasOwnProperty;function Ft(t,e){var r=R(t),n=!r&&fr(t),c=!r&&!n&&Ct(t),a=!r&&!n&&!c&&Jr(t),o=r||n||c||a,u=o?or(t.length,String):[],f=u.length;for(var l in t)(e||Zr.call(t,l))&&!(o&&(l=="length"||c&&(l=="offset"||l=="parent")||a&&(l=="buffer"||l=="byteLength"||l=="byteOffset")||$r(l,f)))&&u.push(l);return u}var Xr=Object.prototype;function H(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||Xr;return t===r}function Mt(t,e){return function(r){return t(e(r))}}var Qr=Mt(Object.keys,Object);const kr=Qr;var tn=Object.prototype,en=tn.hasOwnProperty;function rn(t){if(!H(t))return kr(t);var e=[];for(var r in Object(t))en.call(t,r)&&r!="constructor"&&e.push(r);return e}function Dt(t){return t!=null&&It(t.length)&&!wt(t)}function V(t){return Dt(t)?Ft(t):rn(t)}function nn(t,e){return t&&D(e,V(e),t)}function an(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var on=Object.prototype,sn=on.hasOwnProperty;function cn(t){if(!C(t))return an(t);var e=H(t),r=[];for(var n in t)n=="constructor"&&(e||!sn.call(t,n))||r.push(n);return r}function q(t){return Dt(t)?Ft(t,!0):cn(t)}function un(t,e){return t&&D(e,q(e),t)}var Ut=typeof exports=="object"&&exports&&!exports.nodeType&&exports,st=Ut&&typeof module=="object"&&module&&!module.nodeType&&module,fn=st&&st.exports===Ut,ct=fn?g.Buffer:void 0,ut=ct?ct.allocUnsafe:void 0;function ln(t,e){if(e)return t.slice();var r=t.length,n=ut?ut(r):new t.constructor(r);return t.copy(n),n}function gn(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}function pn(t,e){for(var r=-1,n=t==null?0:t.length,c=0,a=[];++r<n;){var o=t[r];e(o,r,t)&&(a[c++]=o)}return a}function Nt(){return[]}var hn=Object.prototype,bn=hn.propertyIsEnumerable,ft=Object.getOwnPropertySymbols,dn=ft?function(t){return t==null?[]:(t=Object(t),pn(ft(t),function(e){return bn.call(t,e)}))}:Nt;const W=dn;function yn(t,e){return D(t,W(t),e)}function Bt(t,e){for(var r=-1,n=e.length,c=t.length;++r<n;)t[c+r]=e[r];return t}var $n=Mt(Object.getPrototypeOf,Object);const Lt=$n;var Tn=Object.getOwnPropertySymbols,_n=Tn?function(t){for(var e=[];t;)Bt(e,W(t)),t=Lt(t);return e}:Nt;const Gt=_n;function vn(t,e){return D(t,Gt(t),e)}function zt(t,e,r){var n=e(t);return R(t)?n:Bt(n,r(t))}function jn(t){return zt(t,V,W)}function mn(t){return zt(t,q,Gt)}var Sn=T(g,"DataView");const B=Sn;var wn=T(g,"Promise");const L=wn;var An=T(g,"Set");const G=An;var On=T(g,"WeakMap");const z=On;var lt="[object Map]",Pn="[object Object]",gt="[object Promise]",pt="[object Set]",ht="[object WeakMap]",bt="[object DataView]",xn=$(B),Cn=$(O),In=$(L),En=$(G),Fn=$(z),d=x;(B&&d(new B(new ArrayBuffer(1)))!=bt||O&&d(new O)!=lt||L&&d(L.resolve())!=gt||G&&d(new G)!=pt||z&&d(new z)!=ht)&&(d=function(t){var e=x(t),r=e==Pn?t.constructor:void 0,n=r?$(r):"";if(n)switch(n){case xn:return bt;case Cn:return lt;case In:return gt;case En:return pt;case Fn:return ht}return e});const J=d;var Mn=Object.prototype,Dn=Mn.hasOwnProperty;function Un(t){var e=t.length,r=new t.constructor(e);return e&&typeof t[0]=="string"&&Dn.call(t,"index")&&(r.index=t.index,r.input=t.input),r}var Nn=g.Uint8Array;const dt=Nn;function Y(t){var e=new t.constructor(t.byteLength);return new dt(e).set(new dt(t)),e}function Bn(t,e){var r=e?Y(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}var Ln=/\w*$/;function Gn(t){var e=new t.constructor(t.source,Ln.exec(t));return e.lastIndex=t.lastIndex,e}var yt=v?v.prototype:void 0,$t=yt?yt.valueOf:void 0;function zn(t){return $t?Object($t.call(t)):{}}function Rn(t,e){var r=e?Y(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}var Kn="[object Boolean]",Hn="[object Date]",Vn="[object Map]",qn="[object Number]",Wn="[object RegExp]",Jn="[object Set]",Yn="[object String]",Zn="[object Symbol]",Xn="[object ArrayBuffer]",Qn="[object DataView]",kn="[object Float32Array]",ta="[object Float64Array]",ea="[object Int8Array]",ra="[object Int16Array]",na="[object Int32Array]",aa="[object Uint8Array]",oa="[object Uint8ClampedArray]",ia="[object Uint16Array]",sa="[object Uint32Array]";function ca(t,e,r){var n=t.constructor;switch(e){case Xn:return Y(t);case Kn:case Hn:return new n(+t);case Qn:return Bn(t,r);case kn:case ta:case ea:case ra:case na:case aa:case oa:case ia:case sa:return Rn(t,r);case Vn:return new n;case qn:case Yn:return new n(t);case Wn:return Gn(t);case Jn:return new n;case Zn:return zn(t)}}var Tt=Object.create,ua=function(){function t(){}return function(e){if(!C(e))return{};if(Tt)return Tt(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}();const fa=ua;function la(t){return typeof t.constructor=="function"&&!H(t)?fa(Lt(t)):{}}var ga="[object Map]";function pa(t){return I(t)&&J(t)==ga}var _t=j&&j.isMap,ha=_t?K(_t):pa;const ba=ha;var da="[object Set]";function ya(t){return I(t)&&J(t)==da}var vt=j&&j.isSet,$a=vt?K(vt):ya;const Ta=$a;var _a=1,va=2,ja=4,Rt="[object Arguments]",ma="[object Array]",Sa="[object Boolean]",wa="[object Date]",Aa="[object Error]",Kt="[object Function]",Oa="[object GeneratorFunction]",Pa="[object Map]",xa="[object Number]",Ht="[object Object]",Ca="[object RegExp]",Ia="[object Set]",Ea="[object String]",Fa="[object Symbol]",Ma="[object WeakMap]",Da="[object ArrayBuffer]",Ua="[object DataView]",Na="[object Float32Array]",Ba="[object Float64Array]",La="[object Int8Array]",Ga="[object Int16Array]",za="[object Int32Array]",Ra="[object Uint8Array]",Ka="[object Uint8ClampedArray]",Ha="[object Uint16Array]",Va="[object Uint32Array]",i={};i[Rt]=i[ma]=i[Da]=i[Ua]=i[Sa]=i[wa]=i[Na]=i[Ba]=i[La]=i[Ga]=i[za]=i[Pa]=i[xa]=i[Ht]=i[Ca]=i[Ia]=i[Ea]=i[Fa]=i[Ra]=i[Ka]=i[Ha]=i[Va]=!0;i[Aa]=i[Kt]=i[Ma]=!1;function E(t,e,r,n,c,a){var o,u=e&_a,f=e&va,l=e&ja;if(r&&(o=c?r(t,n,c,a):r(t)),o!==void 0)return o;if(!C(t))return t;var Z=R(t);if(Z){if(o=Un(t),!u)return gn(t,o)}else{var _=J(t),X=_==Kt||_==Oa;if(Ct(t))return ln(t,u);if(_==Ht||_==Rt||X&&!c){if(o=f||X?{}:la(t),!u)return f?vn(t,un(o,t)):yn(t,nn(o,t))}else{if(!i[_])return c?t:{};o=ca(t,_,u)}}a||(a=new S);var Q=a.get(t);if(Q)return Q;a.set(t,o),Ta(t)?t.forEach(function(h){o.add(E(h,e,r,h,t,a))}):ba(t)&&t.forEach(function(h,b){o.set(b,E(h,e,r,b,t,a))});var Wt=l?f?mn:jn:f?q:V,k=Z?void 0:Wt(t);return er(k||t,function(h,b){k&&(b=h,h=t[b]),Ot(o,b,E(h,e,r,b,t,a))}),o}var qa=1,Wa=4;function Vt(t){return E(t,qa|Wa)}class Ja{constructor(e,r){r=r||{envParams:{}},this.fnString=e,this.fn=qt(e),this.userParamsSchema=JSON.stringify({}),this.result=[],this.envParams=r.envParams}runOne(e,r=1e4){return new Promise(n=>{const c=setTimeout(()=>{n({data:null,code:1,msg:"timeout",isSuccess:!1,date:new Date().getTime(),userParams:e})},r);this.fn(this.envParams,e).then(a=>{clearTimeout(c),n({data:a,code:0,msg:"success",isSuccess:!0,date:new Date().getTime(),userParams:e})}).catch(a=>{clearTimeout(c),n({data:a,code:(a==null?void 0:a.code)||1,msg:(a==null?void 0:a.message)||"error",isSuccess:!1,date:new Date().getTime(),userParams:e})})})}async run(e){const r=[],{allUserParams:n=[],concurrency:c=1}=e;for(let a=0;a<n.length;a=a+c){const o=await Promise.all(n.slice(a,a+c).map(u=>this.runOne(Vt(u),e.timeout)));r.push(...o)}return this.result.push(...r),r}}const qt=t=>Function(`return ${t}`)(),Ya=t=>{const{rawParams:e,range:r}=t,{start:n,end:c}=r,a=[];for(let o=n;o<=c;o++){const u=Vt(e);u.page=o,a.push(u)}return a},Za={name:"xx爬虫",description:"爬取xx网站的xx数据",fn:`async function fn(env, user) {
    
}`,userParamsSchema:JSON.stringify({title:"微博搜索",description:"A simple form example.",type:"object",required:["q"],properties:{q:{type:"string",title:"查询的字段"}}},null,2)},Xa=t=>/^(async\s+)?function\s*\w*\s*\([\w\s,]*\)\s*\{[\s\S]*\}$/.test(t),Qa=t=>/^async\s*function\s*\w*\s*\([\w\s,]*\)\s*\{[\s\S]*\}$/.test(t),ka=t=>/^[a-zA-Z0-9_-]{4,16}$/.test(t),to=t=>/^[a-zA-Z0-9_-]{6,16}$/.test(t),eo=(t,e)=>t+e;exports.Crawler=Ja;exports.add=eo;exports.checkPassword=to;exports.checkUserName=ka;exports.defaultCrawlerSchema=Za;exports.generateParams=Ya;exports.isAsyncFunctionString=Qa;exports.isFunctionString=Xa;exports.turnFnStringToFn=qt;
//# sourceMappingURL=index.cjs.js.map
