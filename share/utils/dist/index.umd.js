(function(s,A){typeof exports=="object"&&typeof module<"u"?A(exports):typeof define=="function"&&define.amd?define(["exports"],A):(s=typeof globalThis<"u"?globalThis:s||self,A(s["@crawler-manage-share/utils"]={}))})(this,function(s){"use strict";function A(){this.__data__=[],this.size=0}function Q(t,e){return t===e||t!==t&&e!==e}function x(t,e){for(var r=t.length;r--;)if(Q(t[r][0],e))return r;return-1}var Yt=Array.prototype,Zt=Yt.splice;function Xt(t){var e=this.__data__,r=x(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():Zt.call(e,r,1),--this.size,!0}function Qt(t){var e=this.__data__,r=x(e,t);return r<0?void 0:e[r][1]}function kt(t){return x(this.__data__,t)>-1}function te(t,e){var r=this.__data__,n=x(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}function d(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}d.prototype.clear=A,d.prototype.delete=Xt,d.prototype.get=Qt,d.prototype.has=kt,d.prototype.set=te;function ee(){this.__data__=new d,this.size=0}function re(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}function ne(t){return this.__data__.get(t)}function ae(t){return this.__data__.has(t)}var oe=typeof global=="object"&&global&&global.Object===Object&&global;const k=oe;var ie=typeof self=="object"&&self&&self.Object===Object&&self,se=k||ie||Function("return this")();const p=se;var ce=p.Symbol;const v=ce;var tt=Object.prototype,ue=tt.hasOwnProperty,fe=tt.toString,O=v?v.toStringTag:void 0;function le(t){var e=ue.call(t,O),r=t[O];try{t[O]=void 0;var n=!0}catch{}var i=fe.call(t);return n&&(e?t[O]=r:delete t[O]),i}var ge=Object.prototype,pe=ge.toString;function de(t){return pe.call(t)}var he="[object Null]",be="[object Undefined]",et=v?v.toStringTag:void 0;function P(t){return t==null?t===void 0?be:he:et&&et in Object(t)?le(t):de(t)}function C(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var ye="[object AsyncFunction]",Te="[object Function]",$e="[object GeneratorFunction]",_e="[object Proxy]";function rt(t){if(!C(t))return!1;var e=P(t);return e==Te||e==$e||e==ye||e==_e}var ve=p["__core-js_shared__"];const N=ve;var nt=function(){var t=/[^.]+$/.exec(N&&N.keys&&N.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function me(t){return!!nt&&nt in t}var je=Function.prototype,Se=je.toString;function b(t){if(t!=null){try{return Se.call(t)}catch{}try{return t+""}catch{}}return""}var we=/[\\^$.*+?()[\]{}|]/g,Ae=/^\[object .+?Constructor\]$/,Oe=Function.prototype,Pe=Object.prototype,Ce=Oe.toString,Ie=Pe.hasOwnProperty,Ee=RegExp("^"+Ce.call(Ie).replace(we,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Fe(t){if(!C(t)||me(t))return!1;var e=rt(t)?Ee:Ae;return e.test(b(t))}function Me(t,e){return t==null?void 0:t[e]}function y(t,e){var r=Me(t,e);return Fe(r)?r:void 0}var xe=y(p,"Map");const I=xe;var De=y(Object,"create");const E=De;function Ue(){this.__data__=E?E(null):{},this.size=0}function Be(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var Ne="__lodash_hash_undefined__",Le=Object.prototype,Ge=Le.hasOwnProperty;function Re(t){var e=this.__data__;if(E){var r=e[t];return r===Ne?void 0:r}return Ge.call(e,t)?e[t]:void 0}var ze=Object.prototype,Ke=ze.hasOwnProperty;function He(t){var e=this.__data__;return E?e[t]!==void 0:Ke.call(e,t)}var Ve="__lodash_hash_undefined__";function qe(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=E&&e===void 0?Ve:e,this}function T(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}T.prototype.clear=Ue,T.prototype.delete=Be,T.prototype.get=Re,T.prototype.has=He,T.prototype.set=qe;function We(){this.size=0,this.__data__={hash:new T,map:new(I||d),string:new T}}function Je(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function D(t,e){var r=t.__data__;return Je(e)?r[typeof e=="string"?"string":"hash"]:r.map}function Ye(t){var e=D(this,t).delete(t);return this.size-=e?1:0,e}function Ze(t){return D(this,t).get(t)}function Xe(t){return D(this,t).has(t)}function Qe(t,e){var r=D(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}function m(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}m.prototype.clear=We,m.prototype.delete=Ye,m.prototype.get=Ze,m.prototype.has=Xe,m.prototype.set=Qe;var ke=200;function tr(t,e){var r=this.__data__;if(r instanceof d){var n=r.__data__;if(!I||n.length<ke-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new m(n)}return r.set(t,e),this.size=r.size,this}function j(t){var e=this.__data__=new d(t);this.size=e.size}j.prototype.clear=ee,j.prototype.delete=re,j.prototype.get=ne,j.prototype.has=ae,j.prototype.set=tr;function er(t,e){for(var r=-1,n=t==null?0:t.length;++r<n&&e(t[r],r,t)!==!1;);return t}var rr=function(){try{var t=y(Object,"defineProperty");return t({},"",{}),t}catch{}}();const at=rr;function ot(t,e,r){e=="__proto__"&&at?at(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}var nr=Object.prototype,ar=nr.hasOwnProperty;function it(t,e,r){var n=t[e];(!(ar.call(t,e)&&Q(n,r))||r===void 0&&!(e in t))&&ot(t,e,r)}function U(t,e,r,n){var i=!r;r||(r={});for(var a=-1,o=e.length;++a<o;){var f=e[a],l=n?n(r[f],t[f],f,r,t):void 0;l===void 0&&(l=t[f]),i?ot(r,f,l):it(r,f,l)}return r}function or(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}function F(t){return t!=null&&typeof t=="object"}var ir="[object Arguments]";function st(t){return F(t)&&P(t)==ir}var ct=Object.prototype,sr=ct.hasOwnProperty,cr=ct.propertyIsEnumerable,ur=st(function(){return arguments}())?st:function(t){return F(t)&&sr.call(t,"callee")&&!cr.call(t,"callee")};const fr=ur;var lr=Array.isArray;const L=lr;function gr(){return!1}var ut=typeof s=="object"&&s&&!s.nodeType&&s,ft=ut&&typeof module=="object"&&module&&!module.nodeType&&module,pr=ft&&ft.exports===ut,lt=pr?p.Buffer:void 0,dr=lt?lt.isBuffer:void 0,hr=dr||gr;const gt=hr;var br=9007199254740991,yr=/^(?:0|[1-9]\d*)$/;function Tr(t,e){var r=typeof t;return e=e??br,!!e&&(r=="number"||r!="symbol"&&yr.test(t))&&t>-1&&t%1==0&&t<e}var $r=9007199254740991;function pt(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=$r}var _r="[object Arguments]",vr="[object Array]",mr="[object Boolean]",jr="[object Date]",Sr="[object Error]",wr="[object Function]",Ar="[object Map]",Or="[object Number]",Pr="[object Object]",Cr="[object RegExp]",Ir="[object Set]",Er="[object String]",Fr="[object WeakMap]",Mr="[object ArrayBuffer]",xr="[object DataView]",Dr="[object Float32Array]",Ur="[object Float64Array]",Br="[object Int8Array]",Nr="[object Int16Array]",Lr="[object Int32Array]",Gr="[object Uint8Array]",Rr="[object Uint8ClampedArray]",zr="[object Uint16Array]",Kr="[object Uint32Array]",u={};u[Dr]=u[Ur]=u[Br]=u[Nr]=u[Lr]=u[Gr]=u[Rr]=u[zr]=u[Kr]=!0,u[_r]=u[vr]=u[Mr]=u[mr]=u[xr]=u[jr]=u[Sr]=u[wr]=u[Ar]=u[Or]=u[Pr]=u[Cr]=u[Ir]=u[Er]=u[Fr]=!1;function Hr(t){return F(t)&&pt(t.length)&&!!u[P(t)]}function G(t){return function(e){return t(e)}}var dt=typeof s=="object"&&s&&!s.nodeType&&s,M=dt&&typeof module=="object"&&module&&!module.nodeType&&module,Vr=M&&M.exports===dt,R=Vr&&k.process,qr=function(){try{var t=M&&M.require&&M.require("util").types;return t||R&&R.binding&&R.binding("util")}catch{}}();const S=qr;var ht=S&&S.isTypedArray,Wr=ht?G(ht):Hr;const Jr=Wr;var Yr=Object.prototype,Zr=Yr.hasOwnProperty;function bt(t,e){var r=L(t),n=!r&&fr(t),i=!r&&!n&&gt(t),a=!r&&!n&&!i&&Jr(t),o=r||n||i||a,f=o?or(t.length,String):[],l=f.length;for(var g in t)(e||Zr.call(t,g))&&!(o&&(g=="length"||i&&(g=="offset"||g=="parent")||a&&(g=="buffer"||g=="byteLength"||g=="byteOffset")||Tr(g,l)))&&f.push(g);return f}var Xr=Object.prototype;function z(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||Xr;return t===r}function yt(t,e){return function(r){return t(e(r))}}var Qr=yt(Object.keys,Object);const kr=Qr;var tn=Object.prototype,en=tn.hasOwnProperty;function rn(t){if(!z(t))return kr(t);var e=[];for(var r in Object(t))en.call(t,r)&&r!="constructor"&&e.push(r);return e}function Tt(t){return t!=null&&pt(t.length)&&!rt(t)}function K(t){return Tt(t)?bt(t):rn(t)}function nn(t,e){return t&&U(e,K(e),t)}function an(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var on=Object.prototype,sn=on.hasOwnProperty;function cn(t){if(!C(t))return an(t);var e=z(t),r=[];for(var n in t)n=="constructor"&&(e||!sn.call(t,n))||r.push(n);return r}function H(t){return Tt(t)?bt(t,!0):cn(t)}function un(t,e){return t&&U(e,H(e),t)}var $t=typeof s=="object"&&s&&!s.nodeType&&s,_t=$t&&typeof module=="object"&&module&&!module.nodeType&&module,fn=_t&&_t.exports===$t,vt=fn?p.Buffer:void 0,mt=vt?vt.allocUnsafe:void 0;function ln(t,e){if(e)return t.slice();var r=t.length,n=mt?mt(r):new t.constructor(r);return t.copy(n),n}function gn(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}function pn(t,e){for(var r=-1,n=t==null?0:t.length,i=0,a=[];++r<n;){var o=t[r];e(o,r,t)&&(a[i++]=o)}return a}function jt(){return[]}var dn=Object.prototype,hn=dn.propertyIsEnumerable,St=Object.getOwnPropertySymbols,bn=St?function(t){return t==null?[]:(t=Object(t),pn(St(t),function(e){return hn.call(t,e)}))}:jt;const V=bn;function yn(t,e){return U(t,V(t),e)}function wt(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}var Tn=yt(Object.getPrototypeOf,Object);const At=Tn;var $n=Object.getOwnPropertySymbols,_n=$n?function(t){for(var e=[];t;)wt(e,V(t)),t=At(t);return e}:jt;const Ot=_n;function vn(t,e){return U(t,Ot(t),e)}function Pt(t,e,r){var n=e(t);return L(t)?n:wt(n,r(t))}function mn(t){return Pt(t,K,V)}function jn(t){return Pt(t,H,Ot)}var Sn=y(p,"DataView");const q=Sn;var wn=y(p,"Promise");const W=wn;var An=y(p,"Set");const J=An;var On=y(p,"WeakMap");const Y=On;var Ct="[object Map]",Pn="[object Object]",It="[object Promise]",Et="[object Set]",Ft="[object WeakMap]",Mt="[object DataView]",Cn=b(q),In=b(I),En=b(W),Fn=b(J),Mn=b(Y),$=P;(q&&$(new q(new ArrayBuffer(1)))!=Mt||I&&$(new I)!=Ct||W&&$(W.resolve())!=It||J&&$(new J)!=Et||Y&&$(new Y)!=Ft)&&($=function(t){var e=P(t),r=e==Pn?t.constructor:void 0,n=r?b(r):"";if(n)switch(n){case Cn:return Mt;case In:return Ct;case En:return It;case Fn:return Et;case Mn:return Ft}return e});const Z=$;var xn=Object.prototype,Dn=xn.hasOwnProperty;function Un(t){var e=t.length,r=new t.constructor(e);return e&&typeof t[0]=="string"&&Dn.call(t,"index")&&(r.index=t.index,r.input=t.input),r}var Bn=p.Uint8Array;const xt=Bn;function X(t){var e=new t.constructor(t.byteLength);return new xt(e).set(new xt(t)),e}function Nn(t,e){var r=e?X(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}var Ln=/\w*$/;function Gn(t){var e=new t.constructor(t.source,Ln.exec(t));return e.lastIndex=t.lastIndex,e}var Dt=v?v.prototype:void 0,Ut=Dt?Dt.valueOf:void 0;function Rn(t){return Ut?Object(Ut.call(t)):{}}function zn(t,e){var r=e?X(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}var Kn="[object Boolean]",Hn="[object Date]",Vn="[object Map]",qn="[object Number]",Wn="[object RegExp]",Jn="[object Set]",Yn="[object String]",Zn="[object Symbol]",Xn="[object ArrayBuffer]",Qn="[object DataView]",kn="[object Float32Array]",ta="[object Float64Array]",ea="[object Int8Array]",ra="[object Int16Array]",na="[object Int32Array]",aa="[object Uint8Array]",oa="[object Uint8ClampedArray]",ia="[object Uint16Array]",sa="[object Uint32Array]";function ca(t,e,r){var n=t.constructor;switch(e){case Xn:return X(t);case Kn:case Hn:return new n(+t);case Qn:return Nn(t,r);case kn:case ta:case ea:case ra:case na:case aa:case oa:case ia:case sa:return zn(t,r);case Vn:return new n;case qn:case Yn:return new n(t);case Wn:return Gn(t);case Jn:return new n;case Zn:return Rn(t)}}var Bt=Object.create,ua=function(){function t(){}return function(e){if(!C(e))return{};if(Bt)return Bt(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}();const fa=ua;function la(t){return typeof t.constructor=="function"&&!z(t)?fa(At(t)):{}}var ga="[object Map]";function pa(t){return F(t)&&Z(t)==ga}var Nt=S&&S.isMap,da=Nt?G(Nt):pa;const ha=da;var ba="[object Set]";function ya(t){return F(t)&&Z(t)==ba}var Lt=S&&S.isSet,Ta=Lt?G(Lt):ya;const $a=Ta;var _a=1,va=2,ma=4,Gt="[object Arguments]",ja="[object Array]",Sa="[object Boolean]",wa="[object Date]",Aa="[object Error]",Rt="[object Function]",Oa="[object GeneratorFunction]",Pa="[object Map]",Ca="[object Number]",zt="[object Object]",Ia="[object RegExp]",Ea="[object Set]",Fa="[object String]",Ma="[object Symbol]",xa="[object WeakMap]",Da="[object ArrayBuffer]",Ua="[object DataView]",Ba="[object Float32Array]",Na="[object Float64Array]",La="[object Int8Array]",Ga="[object Int16Array]",Ra="[object Int32Array]",za="[object Uint8Array]",Ka="[object Uint8ClampedArray]",Ha="[object Uint16Array]",Va="[object Uint32Array]",c={};c[Gt]=c[ja]=c[Da]=c[Ua]=c[Sa]=c[wa]=c[Ba]=c[Na]=c[La]=c[Ga]=c[Ra]=c[Pa]=c[Ca]=c[zt]=c[Ia]=c[Ea]=c[Fa]=c[Ma]=c[za]=c[Ka]=c[Ha]=c[Va]=!0,c[Aa]=c[Rt]=c[xa]=!1;function B(t,e,r,n,i,a){var o,f=e&_a,l=e&va,g=e&ma;if(r&&(o=i?r(t,n,i,a):r(t)),o!==void 0)return o;if(!C(t))return t;var Vt=L(t);if(Vt){if(o=Un(t),!f)return gn(t,o)}else{var w=Z(t),qt=w==Rt||w==Oa;if(gt(t))return ln(t,f);if(w==zt||w==Gt||qt&&!i){if(o=l||qt?{}:la(t),!f)return l?vn(t,un(o,t)):yn(t,nn(o,t))}else{if(!c[w])return i?t:{};o=ca(t,w,f)}}a||(a=new j);var Wt=a.get(t);if(Wt)return Wt;a.set(t,o),$a(t)?t.forEach(function(h){o.add(B(h,e,r,h,t,a))}):ha(t)&&t.forEach(function(h,_){o.set(_,B(h,e,r,_,t,a))});var no=g?l?jn:mn:l?H:K,Jt=Vt?void 0:no(t);return er(Jt||t,function(h,_){Jt&&(_=h,h=t[_]),it(o,_,B(h,e,r,_,t,a))}),o}var qa=1,Wa=4;function Kt(t){return B(t,qa|Wa)}class Ja{constructor(e,r){r=r||{envParams:{}},this.fnString=e,this.fn=Ht(e),this.userParamsSchema=JSON.stringify({}),this.result=[],this.envParams=r.envParams}runOne(e,r=1e4){return new Promise(n=>{const i=setTimeout(()=>{n({data:null,code:1,msg:"timeout",isSuccess:!1,date:new Date().getTime(),userParams:e})},r);this.fn(this.envParams,e).then(a=>{clearTimeout(i),n({data:a,code:0,msg:"success",isSuccess:!0,date:new Date().getTime(),userParams:e})}).catch(a=>{clearTimeout(i),n({data:a,code:(a==null?void 0:a.code)||1,msg:(a==null?void 0:a.message)||"error",isSuccess:!1,date:new Date().getTime(),userParams:e})})})}async run(e){const r=[],{allUserParams:n=[],concurrency:i=1}=e;for(let a=0;a<n.length;a=a+i){const o=await Promise.all(n.slice(a,a+i).map(f=>this.runOne(Kt(f),e.timeout)));r.push(...o)}return this.result.push(...r),r}}const Ht=t=>Function(`return ${t}`)(),Ya=t=>{const{params1:e,params2:r,commonParams:n}=t,i=[];for(let a=0;a<e.length;a++)for(let o=0;o<r.length;o++)i.push({...n,...e[a],...r[o]});return i},Za=(t,e)=>{const{start:r,end:n}=e,i=[];for(let a=r;a<=n;a++){const o=Kt(t);o.page=a,i.push(o)}return i},Xa={name:"xx爬虫",description:"爬取xx网站的xx数据",fn:`async function fn(env, user) {
    
}`,userParamsSchema:JSON.stringify({title:"微博搜索",description:"A simple form example.",type:"object",required:["q"],properties:{q:{type:"string",title:"查询的字段"}}},null,2)},Qa=t=>/^(async\s+)?function\s*\w*\s*\([\w\s,]*\)\s*\{[\s\S]*\}$/.test(t),ka=t=>/^async\s*function\s*\w*\s*\([\w\s,]*\)\s*\{[\s\S]*\}$/.test(t),to=t=>/^[a-zA-Z0-9_-]{4,16}$/.test(t),eo=t=>/^[a-zA-Z0-9_-]{6,16}$/.test(t),ro=(t,e)=>t+e;s.Crawler=Ja,s.add=ro,s.checkPassword=eo,s.checkUserName=to,s.defaultCrawlerSchema=Xa,s.generateParams=Ya,s.generateParamsByRange=Za,s.isAsyncFunctionString=ka,s.isFunctionString=Qa,s.turnFnStringToFn=Ht,Object.defineProperty(s,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=index.umd.js.map
